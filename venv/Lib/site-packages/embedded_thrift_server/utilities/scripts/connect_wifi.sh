#!/bin/bash
if [ "$#" -le 2 ]; then
echo "Connecting to $1"
nmcli d wifi connect "$1" password $2
else
echo "Connecting to $1 under user $2"
nmcli c delete "$1"
nmcli connection --ask add type wifi con-name "$1" ifname wlan0 ssid "$1" -- wifi-sec.key-mgmt wpa-eap 802-1x.eap peap 802-1x.identity $2 802-1x.phase2-auth mschapv2 802-1x.anonymous-identity $2 <<!
no
no
no
no
!
nmcli --ask con up "$1" <<!
$2
$3
!
fi

