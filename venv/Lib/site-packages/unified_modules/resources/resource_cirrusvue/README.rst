Cirrusvue resource
=========================

This resource is used to generate the wheel file for cirrusvue.


Description
-----------

Cirrusvue is used to configure the Audiohub fpga as an alternative for resource_scslinkapi.

resource_cirrusvue is used to checkout the cirrusvue code into the folder and generate wheel file
for it. Code is downloaded from below repos into the cirrusvue directory:
https://aus-svn-01.ad.cirrus.com/svn/msa_apps_projects/Python_Tools/cirrusvue/main/trunk/common/
https://aus-svn-01.ad.cirrus.com/svn/msa_apps_projects/Python_Tools/cirrusvue/main/trunk/core/

Installation
------------
Cirrusvue' has ``setuptools`` support. The current, proper, way of
installing it is to generate a ``wheel`` package from its sources and install
that package using ``pip``.

To generate the ``wheel`` package follow below steps:
- Checkout cirrusvue common and core code into cirrusvue directory.
common: https://aus-svn-01.ad.cirrus.com/svn/msa_apps_projects/Python_Tools/cirrusvue/main/trunk/common/
core: https://aus-svn-01.ad.cirrus.com/svn/msa_apps_projects/Python_Tools/cirrusvue/main/trunk/core/

.. code-block:: sh

    $ python setup.py bdist_wheel

After execution, package should have been generated in the ``dist`` subfolder.

Prerequisite for installing the wheel file:
- Install (Windows only) Microsoft Visual C++ Compiler for Python 2.7 http://www.microsoft.com/en-us/download/details.aspx?id=44266.

The generated package can then be installed running:

.. code-block:: sh

    $ python -m pip install --user <cirrusvue package>.whl


Documentation
-------------

https://docs.cirrus.com/display/AAPPS/Cirrusvue


Development
-----------

Developers can install Cirrusvue' package in a special mode called
editable mode. In that mode, sources can be modified in place without having to
generate and reinstall the ``wheel`` package for every change made to the code.

To install the package in editable mode, run, from the ``core`` directory:

.. code-block:: sh

    $ python -m pip install --user --editable .

Usage
-----
from cirrusvue.core.connection.cirruslink.discovery import get_audiohub2
from cirrusvue.common.audiohub2 import AudioHub as AudioHub2

link = get_audiohub2(hubname='ah2-0D958B', transport='rndis')
hub = AudioHub2(link)
fpga = hub.fpga
fpga.write_field("XUSB_SDIN1_SEL", 0x1C)  # XUSB_SDO1
fpga.write_field("XUSB_SDIN2_SEL", 0x1C)  # XUSB SDO1
fpga.write_field("XUSB_SDIN3_SEL", 0x1C)  # XUSB SDO1
fpga.write_field("XUSB_SDIN4_SEL", 0x1C)  # XUSB SDO1