###############################################################################
##
## Copyright (c) 2015 Cirrus Logic International (UK) Ltd.  All rights reserved.
##
## This software as well as any related documentation is furnished under
## license and may only be used or copied in accordance with the terms of the
## license. The information in this file is furnished for informational use
## only, is subject to change without notice, and should not be construed as
## a commitment by Cirrus Logic International (UK) Ltd.  Cirrus Logic International
## (UK) Ltd assumes no responsibility or liability for any errors or inaccuracies
## that may appear in this document or any software that may be provided in
## association with this document.
##
## Except as permitted by such license, no part of this document may be
## reproduced, stored in a retrieval system, or transmitted in any form or by
## any means without the express written consent of Cirrus Logic International
## (UK) Ltd or affiliated companies.
##
## @file acceptance_steps.rb
## @brief Step-definitions for invoking nested steps and checking failure.
##
## @version \$Id: acceptance_steps.rb 1013 2015-04-27 14:24:00Z aangus $
##
## @warning
##     This software is specifically written for Cirrus Logic devices.
##     It may not be used with other devices.
##
###############################################################################

###############################################################################
# @private
# @!method Then_Nested_Step_Fail
#
# Allows a step to be tagged as failing, will then invoke that step.
#
# @note Used for acceptance testing the Fruit Salad framework (steps do fail).
#       Required as a distinct step definition to match where there is no tabular data.
#
#       Usage:
#       Then {FAIL} <another step>
#
# @param nested_step   Step to be executed and checked for failing.
#
# @example Then {FAIL} <another step>
#
###############################################################################
Then( /^{FAIL} (.*[^:])$/ ) do |nested_step|
	check_step_failed( nested_step )
end

###############################################################################
# @private
# @!method Then_Nested_Step_Fail_With_Table
#
# Allows a step to be tagged as failing, will then invoke that step, with the given table.
#
# @note Used for acceptance testing the Fruit Salad framework (steps do fail).
#       Required as a distinct step definition to match where there is no tabular data.
#
#       Usage:
#       Then {FAIL} <another step>: <table>
#
# @param nested_step   Step to be executed and checked for failing.
# @param table         Tabular data to be passed into the step.
#
# @example Then {FAIL} <another step>:
#      | Example |
#      | Table   |
#
###############################################################################
Then( /^{FAIL} (.*:)$/ ) do |nested_step, table|
	check_step_failed( nested_step, table )
end

#################################### end ########################################