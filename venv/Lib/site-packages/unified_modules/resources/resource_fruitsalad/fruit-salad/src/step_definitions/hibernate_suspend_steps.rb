################################################################################
###
### Copyright (c) 2014-2015 Cirrus Logic International (UK) Ltd.  All rights reserved.
###
### This software as well as any related documentation is furnished under
### license and may only be used or copied in accordance with the terms of the
### license. The information in this file is furnished for informational use
### only, is subject to change without notice, and should not be construed as
### a commitment by Cirrus Logic International (UK) Ltd.  Cirrus Logic International
### (UK) Ltd assumes no responsibility or liability for any errors or inaccuracies
### that may appear in this document or any software that may be provided in
### association with this document.
###
### Except as permitted by such license, no part of this document may be
### reproduced, stored in a retrieval system, or transmitted in any form or by
### any means without the express written consent of Cirrus Logic International
### (UK) Ltd or affiliated companies.
###
### @file hibernate_suspend_steps.rb
### @brief Step definition for triggering hibernation and suspend in Windows.
###
### @version \$Id: hibernate_suspend_steps.rb 1051 2015-05-21 14:50:02Z aangus $
###
### @warning
###    This software is specifically written for Cirrus Logic devices.
###    It may not be used with other devices.
###
################################################################################

################################################################################
#
# @!method When_I_suspend_for_duration
#
# Put the computer in a hibernate or suspend state for a set duration
# then wake automatically.
#
# In order to operate correctly Wake Timers must be allowed in Advanced Power
# Settings. Source: https://social.msdn.microsoft.com/Forums/windowsdesktop/en-US/654f0c7c-6514-4aaa-a975-33363f5c0813/cant-wake-up-system-from-standby-in-win7-through-setwaitabletimer?forum=windowssdk
#
# Additionally the duration is a minimum, not expected value as the system can
# take a considerable amount of time entering the suspend or hibernation state.
#
#       Usage - one of:
#       When I hibernate for <duration> seconds
#       When I suspend for <duration> seconds
#
# @example When I enter hibernation for 30 seconds
# @example When I enter suspend for 7 seconds
#
# @param duration The minimum length of time to remain suspended, not including
#                 the time taken to wake up again.
#
###############################################################################
When( /^I (hibernate|suspend) for (#{Number}) seconds$/ ) do |power_state, duration|
    if "hibernate" == power_state
        FruitSalad::get_device().hibernate_for_duration( duration )
    else
        FruitSalad::get_device().suspend_for_duration( duration )
    end
end

############################## END OF FILE ####################################