################################################################################
##
## Copyright (c) 2015 Cirrus Logic International (UK) Ltd.  All rights reserved.
##
## This software as well as any related documentation is furnished under 
## license and may only be used or copied in accordance with the terms of the 
## license. The information in this file is furnished for informational use 
## only, is subject to change without notice, and should not be construed as 
## a commitment by Cirrus Logic International (UK) Ltd.  Cirrus Logic International
## (UK) Ltd assumes no responsibility or liability for any errors or inaccuracies
## that may appear in this document or any software that may be provided in
## association with this document. 
##
## Except as permitted by such license, no part of this document may be 
## reproduced, stored in a retrieval system, or transmitted in any form or by 
## any means without the express written consent of Cirrus Logic International
## (UK) Ltd or affiliated companies.  
##
### @file  WISCE_installers.feature
### @brief Scenarios for checking WISCESetup installer works correctly.
###
### WISCESetup should install the ExtensionsSDK and and device packs located alongside it on install.
###
### @version \$Id: WISCE_installers.feature 847 2015-02-06 15:55:37Z aangus $
###
### @warning
###   This software is specifically written for Cirrus Logic devices.
###   It may not be used with other devices.
###
#################################################################################
@build_tests
Feature: Check that WISCE and sub-installers (Device packs, ExtensionsSDK) can be installed independently or alongside the main installer.
    
    ###########################################################################
    #
    # Always run from a sub directory from which the sub-installers can be picked up
    # as intended.
    #
    ###########################################################################
    Background:
        Given I am running installers from "installers"
        And the installers directory is clean
    
    ###########################################################################
    #
    # Copy across the latest WISCEExtensionsSDK, execute and check for install
    #
    ###########################################################################
    Scenario: Install the latest WISCEExtensionsSDK
        Given WISCE is installed
        Given available installer WISCEExtensionsSDK.exe
        When I run the WISCEExtensionsSDK.exe installer
        Then WISCEExtensionsSDK has been installed

    ###########################################################################
    #
    # Make sure the WISCEExtensionsSDK is present, then uninstall and recheck that it was.
    #
    ###########################################################################    
    Scenario: Check that WISCEExtensionsSDK can be detected and uninstalled
        Given WISCE is installed
        Given WISCEExtensionsSDK is installed
        Given WISCEExtensionsSDK is uninstalled
        Then WISCEExtensionsSDK has been uninstalled

    ###########################################################################
    #
    # Check whether the WISCEExtensionsSDK is installed alongside WISCE.
    #
    ###########################################################################    
    Scenario: We can install the ExtensionsSDK alongside WISCE - local drive
        Given WISCEExtensionsSDK is uninstalled
        Given available installer WISCEExtensionsSDK.exe
        Given available installer WISCESetup.exe
        When I run the WISCESetup.exe installer
        Then WISCE has been installed
        Then WISCEExtensionsSDK has been installed
    
    ###########################################################################
    #
    # Cirrus names device packs can be installed correctly
    #
    ###########################################################################
    Scenario: Install a Cirrus device pack
        Given available installer CS47L85 version 2.1
        When I run the CS47L85Setup_Rev2_1.exe installer
        Then the device pack CS47L85 has been installed
        Then the device pack CS47L85 version 2.0 has not been installed
    
    ###########################################################################
    #
    # Cirrus named device packs can be installed with replace correctly
    #
    ###########################################################################
    Scenario: Device packs installed with replace remove all previous versions.
        Given I am running installers from "device_packs"
        Given the device pack WM1111 version 2.1 is installed
        Given the device pack WM1111 version 2.3 is installed
        When I run the CS47L85Setup_Rev9_9.exe installer
        Then the device pack CS47L85 version 9.9 has been installed
        Then the device pack WM1111 version 2.1 has been uninstalled
        Then the device pack WM1111 version 2.3 has been uninstalled

    ###########################################################################
    #
    # Installing the Simple Device packs should overwrite one another as the Firmware GUID is identical in each case.
    #
    ###########################################################################
    Scenario: Installing Firmware named device packs should always be singular.
        Given I am running installers from "device_packs"
        When I run the SingleDeviceSetup_Rev2_1.exe installer
        Then the device pack SingleDevice has been installed        
        When I run the SingleDeviceSetup_Rev2_2.exe installer
        Then the device pack SingleDevice has been installed    
        When I run the SingleDeviceSetup_Rev2_3.exe installer
        Then the device pack SingleDevice has been installed    
        Then the device pack SingleDevice version 2.1 has not been installed
        Then the device pack SingleDevice version 2.2 has not been installed
        
    ###########################################################################
    #
    # Check that CS and WM device packs are installed alongside WISCE.
    #
    ###########################################################################    
    Scenario: We can install device packs alongside WISCE
        Given the device pack CS47L85 is uninstalled
        Given the device pack WM1111 version 2.3 is uninstalled
        Given available installer WISCESetup.exe
        Given available installer CS47L85 version 2.1
        Given available installer WM1111 version 2.3
        When I run the WISCESetup.exe installer
        Then WISCE is installed
        Then the device pack CS47L85 version 2.1 has been installed
        Then the device pack WM1111 version 2.3 has been installed
        
################################## END OF FILE ###################################