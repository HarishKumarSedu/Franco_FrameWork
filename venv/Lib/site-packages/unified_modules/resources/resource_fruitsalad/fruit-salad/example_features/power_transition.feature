################################################################################
###
### Copyright (c) 2014 Wolfson Microelectronics plc.  All rights reserved.
###
### This software as well as any related documentation is furnished under 
### license and may only be used or copied in accordance with the terms of the 
### license. The information in this file is furnished for informational use 
### only, is subject to change without notice, and should not be construed as 
### a commitment by Wolfson Microelectronics plc. Wolfson Microelectronics plc
### assumes no responsibility or liability for any errors or inaccuracies that
### may appear in this document or any software that may be provided in
### association with this document. 
###
### Except as permitted by such license, no part of this document may be 
### reproduced, stored in a retrieval system, or transmitted in any form or by 
### any means without the express written consent of Wolfson Microelectronics plc. 
###
### @file power_transition.feature
### @brief Test whether expected power state transitions occur with the codec driver.
###
### @version \$Id: power_transition.feature 523 2014-11-28 10:29:13Z emmas $
###
### Warning
###   This software is specifically written for Wolfson devices. It may not be
###   used with other devices.
###
#################################################################################
#
# Our driver is expected to perform a number of power state transisions according
# to the demand for the devices resources: i.e. power down when not in use.
#
# This feature file specifies acceptance tests for that behavior as defined by
# the manual testing document sent to us.
#
# This feature file functions only on Windows.
#
###############################################################################
@windows
Feature: PowerStateTransitions
    Our device is expected to go to sleep when not in use, and wake again when
    needed again.

    ###########################################################################
    #
    # Check that the device returns to Power state D3 within a reasonable time
    # after playback terminates.
    #
    ###########################################################################    
    Scenario: Go to sleep within 2 minutes
        Given the codec is in power state D0
        When I play the audio file "resources/test.wav"
        Then the codec enters power state D3 within 2 minutes

    ###########################################################################
    #
    # Perform state transitions when a headset jack is inserted.
    #
    # This task requires manual user intervention and should not be run as part of continuous integration.
    #
    ###########################################################################
    @manual
    Scenario: Go to D0 when a 4-pole jack is inserted.
        Given there is no jack inserted
        And the codec is in power state D3
        When I insert a jack
        Then the codec enters power state D0 within 0.5 minutes

################################# END OF FILE #################################
