################################################################################
###
### Copyright (c) 2014 Wolfson Microelectronics plc.  All rights reserved.
###
### This software as well as any related documentation is furnished under 
### license and may only be used or copied in accordance with the terms of the 
### license. The information in this file is furnished for informational use 
### only, is subject to change without notice, and should not be construed as 
### a commitment by Wolfson Microelectronics plc. Wolfson Microelectronics plc
### assumes no responsibility or liability for any errors or inaccuracies that
### may appear in this document or any software that may be provided in
### association with this document. 
###
### Except as permitted by such license, no part of this document may be 
### reproduced, stored in a retrieval system, or transmitted in any form or by 
### any means without the express written consent of Wolfson Microelectronics plc. 
###
### @file manual_usecase.feature
### @brief An example test specifying a set of usecase scripts as a step.
###
### @version \$Id: manual_usecase.feature 446 2014-11-18 14:11:59Z emmas $
###
### Warning
###   This software is specifically written for Wolfson devices. It may not be
###   used with other devices.
###
#################################################################################
#
# Demonstration that we can specify usecase scripts explicitly as a part of a
# feature file, i.e. to configure routing and hardware settings specifically
# for that scenario.
#
# This feature only passes on Linux/Android targets with tinyalsa available.
#
###############################################################################
@linux
Feature: Manual Usecase Specification
    We should be able to explicitly specify a usecase as a part of our scenario
    definition. Further, each seperate scenario should automatically 'rollback'
    to the default state after each test to prevent our explicit usecases
    bleeding through to subsequent tests.

    ###########################################################################
    #
    # TC1170 Explicitly load a usecase and verify that playback/record functions
    # with non-silent captured output. Also verify that we have the correct 
    # mixer properties.
    #
    ###########################################################################
    Scenario: Explicitly load a usecase
        Given I load use case "Playback_to_Line_Out"
        And use case "Record_from_Mic_In"
        And I am recording the output
        When I play a 440 Hz sine wave for 5 seconds
        Then the output was not silence
        And mixer property "HPOUT1L Input 1" = "None"
        And mixer property "HPOUT2L Input 1" = "AIF1RX1"

    ###########################################################################
    #
    # TC1172 The usecase should be implicitly reverted to the default state.
    #
    ###########################################################################
    Scenario: Implicitly revert usecase between stories
        Given I am recording the output
        When I play a 1 kHz sine wave for 5 seconds
        Then the output was not silence
        And mixer property "HPOUT1L Input 1" = "AIF1RX1"
        And mixer property "HPOUT2L Input 1" = "None"

############################ END OF FILE ######################################