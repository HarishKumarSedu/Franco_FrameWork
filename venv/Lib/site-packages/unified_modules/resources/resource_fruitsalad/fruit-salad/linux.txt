###############################################################################
###
### Copyright (c) 2014-2015 Cirrus Logic International (UK) Ltd.  All rights reserved.
###
### This software as well as any related documentation is furnished under
### license and may only be used or copied in accordance with the terms of the
### license. The information in this file is furnished for informational use
### only, is subject to change without notice, and should not be construed as
### a commitment by Cirrus Logic International (UK) Ltd.  Cirrus Logic International
### (UK) Ltd assumes no responsibility or liability for any errors or inaccuracies
### that may appear in this document or any software that may be provided in
### association with this document.
###
### Except as permitted by such license, no part of this document may be
### reproduced, stored in a retrieval system, or transmitted in any form or by
### any means without the express written consent of Cirrus Logic International
### (UK) Ltd or affiliated companies.
###
### @file linux.txt
### @brief Installation, usage and development notes for GNU Linux.
###
### @version $Id: linux.txt 961 2015-03-18 14:54:29Z piotrs $
###
### @warning
###    This software is specifically written for Cirrus Logic devices.
###    It may not be used with other devices.
###
###############################################################################

Installation Steps for Debian Linux

NOTE: As yet these have only been tested under Raspbian.

1. Install Ruby and Gem.
    $ sudo apt-get install ruby ruby-dev gem
2. Install Bundle
    $ sudo gem install bundle
3. Extract the Fruit Salad archive and cd into that directory
4. Install dependencies
    $ bundle install
5. Set executable permissions on fruitsalad.rb
    $ chmod +x fruitsalad.rb
6. Build tinyalsa and copy binaries to the lib/ directory (if not using Android)
    $ cd vendor/tinyalsa
    $ make
    $ cp libtinyalsa.so tinycap tinymix tinypcminfo tinyplay ../
    $ chmod +x ../tiny*
7. Install one of libfft.arm.so or libfft.x86.so to /usr/local/lib or another
   system shared library location.
[8.] If you are using Debian you will need to add /usr/local/lib to /etc/ld.so.conf
   and run:
    $ sudo /sbin/ldconfig
9. Install OpenAL
    $ sudo apt-get install libopenal-dev

Once installed you can invoke a Fruit Salad test for Pi with:
    $ ruby <path to FruitSalad>/fruitsalad.rb linux -f <path to feature> -c <path to config>

To run FruitSalad from outside the install directory without an absolute path:
  1. Set or append the path to the install directory to the environment variable RUBYPATH
  2. run ruby with the -S option to search the install directory for fruitsalad.rb
      $ ruby -S fruitsalad.rb linux -f <path to feature> -c <path to config>
  3. Alternative configs and features directories will be checked in preference to
     those found in the FruitSalad install directory.

Saladmix

Relying on tinymix directly to execute usecase scripts can be excessively slow.
In order to get around this problem with have provided the saladmix utility which
performs bulk writes on tinyalsa mixer properties, instead of openning and closing
the device for each property.

To use saladmix perform the following steps:
    1. Obtain saladmix binary for the target platform (./bin/arm-linux-androideabi-saladmix for Android)
        or build from src/extensions/saladmix using GCC
    2. Add the following keys to your fruitsalad config file...
        2a. SaladMix_Location: "<location and name of saladmix>"
        2b. SaladMix_Upload: true
