# @title Testing SoundClear Control on Arndale
<!--============================================================================
==
== Copyright (c) 2014-2015 Cirrus Logic International (UK) Ltd.  All rights reserved.
==
== This software as well as any related documentation is furnished under 
== license and may only be used or copied in accordance with the terms of the 
== license. The information in this file is furnished for informational use 
== only, is subject to change without notice, and should not be construed as 
== a commitment by Cirrus Logic International (UK) Ltd.  Cirrus Logic International
== (UK) Ltd assumes no responsibility or liability for any errors or inaccuracies
== that may appear in this document or any software that may be provided in
== association with this document. 
==
== Except as permitted by such license, no part of this document may be 
== reproduced, stored in a retrieval system, or transmitted in any form or by 
== any means without the express written consent of Cirrus Logic International
== (UK) Ltd or affiliated companies. 
==
== @file    SoundClearControlArndale.md
== @brief   How to on SoundClear Control testing on Arndale.
==
== @version \$Id: SoundClearControlArndale.md 840 2015-02-06 08:41:31Z piotrs $
==
== @warning
==   This software is specifically written for Cirrus Logic devices.
==   It may not be used with other devices.
==
=============================================================================-->

Testing SoundClear&reg; Control on Arndale
=====================================

Introduction
------------

This how to describes how to run a simple SoundClear Control (also called Ez2
control™) trigger test with FruitSalad.

Prerequisites
-------------

* Arndale configured to accept SSH connections
* Arndale `/system` partition must be writable
* WISCEBridge™ (LinuxBridge) compiled for Android and installed on the Arndale

Making Android `/system` partition writable
-----------------------------------------

The `/system` partition can be made writable in two ways. If the device is
connected to your PC with a USB cable you can simply run:

    adb remount

Alternatively, connect to your device via ssh (as root) and run the following
command:

    mount -o rw,remount /system

<br>

    *** NOTE ***

    You will need to remount the /system partition after each reboot.

    *** NOTE ***

Compiling and installing WISCEBridge™ for Arndale
-------------------------------------------------

1. Install WISCE™ Extensions SDK.
2. Navigate to `<WISCEExtensionsSDKInstallDir>\WISCEBridge\Linux` .
3. Backup `ftw.h`, `ftw.cpp` and `Makefile`.
4. Paste `ftw.h`, `ftw.cpp` and `Makefile` from `<FruitSaladRepo>/ez2control`.
5. Make sure you have an Android NDK standalone tool chain on your path.
6. Run `make` or `nmake`, for example:

    make RM=del ECHO=echo SEP=\\ CROSS_COMPILE=arm-linux-androideabi-

7. Copy the resulting executable - `wbridge` - to `/vendor/bin` on your Arndale,
   and make sure it is executable.

        adb shell mkdir -p /vendor/bin # make sure the directory exists
        adb push wbridge /vendor/bin/wbridge
        adb shell chmod +x /vendor/bin/wbridge # make wbridge executable

Running the test
----------------

The test can be executed simply by running:

    ruby fruitsalad.rb remote -f features\soundclear_control.feature -c <your config> [-a <user name>:<ip address>]

An example FruitSalad configuration file is located at
`<FruitSaladInstallDir>\configs\arndale.yaml`.
