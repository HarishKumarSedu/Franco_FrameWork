# encoding: utf-8
################################################################################
### Copyright (c) 2015 Cirrus Logic International (UK) Ltd.  All rights reserved.
###
### This software as well as any related documentation is furnished under
### license and may only be used or copied in accordance with the terms of the
### license. The information in this file is furnished for informational use
### only, is subject to change without notice, and should not be construed as
### a commitment by Cirrus Logic International (UK) Ltd.  Cirrus Logic International
### (UK) Ltd assumes no responsibility or liability for any errors or inaccuracies
### that may appear in this document or any software that may be provided in
### association with this document.
###
### Except as permitted by such license, no part of this document may be
### reproduced, stored in a retrieval system, or transmitted in any form or by
### any means without the express written consent of Cirrus Logic International
### (UK) Ltd or affiliated companies.
###
### @file   testFruitSaladLauncher.rb
### @brief  Testing FruitSaladLauncher (defined in fruitsalad.rb).
###
### @version \$Id: testFruitSaladLauncher.rb 1050 2015-05-20 19:11:02Z aangus $
###
### @warning
###   This software is specifically written for Cirrus Logic devices.
###   It may not be used with other devices.
################################################################################
# ensure that the gem version of test-unit is loaded
# otherwise the report generation will not occur.
gem 'test-unit'
require 'test/unit'

require_relative '../fruitsalad.rb'

exit unless ENV['TARGET'].nil?

################################################################################
# Class: TestFruitSaladLauncher
#
# Test case for the generic classes/methods in the FruitSaladBase module.
#
################################################################################
class TestFruitSaladLauncher < Test::Unit::TestCase

    ############################################################################
    # @function setup
    #
    # setup method run before each test case
    #
    # (no parameters)
    #
    ############################################################################
    def setup
        @launcher = FruitSaladLauncher.new( true )
    end

    ############################################################################
    # @function test_available_platforms
    #
    # Check that the expected platforms are available.
    #
    # (no parameters)
    #
    ############################################################################
    def test_available_platforms
        expected_platform_files = 6
        platforms = @launcher.available_platforms
        assert_equal( expected_platform_files,  platforms.length, 'Incorrect number of platform files found' )

        assert_equal( 'LinuxSalad.rb',         platforms[0] )
        assert_equal( 'NullSalad.rb',          platforms[1] )
        assert_equal( 'RemoteSalad.rb',        platforms[2] )
        assert_equal( 'WindowsRemoteSalad.rb', platforms[3] )
        assert_equal( 'WindowsSalad.rb',       platforms[4] )
        assert_equal( 'WISCESalad.rb',         platforms[5] )
    end

    ############################################################################
    # @function test_available_platforms
    #
    # Check that the correct platform has been selected.
    #
    # (no parameters)
    #
    ############################################################################
    def test_platform_lookup()
        assert_equal( 'NullSalad.rb',           @launcher.platform_lookup, 'Default NullSalad.rb target not set.' )
        assert_equal( 'WISCESalad.rb',          @launcher.platform_lookup( 'wisce' ) )
        assert_equal( 'WindowsSalad.rb',        @launcher.platform_lookup( 'windows' ) )
        assert_equal( 'WindowsRemoteSalad.rb',  @launcher.platform_lookup( 'windowsremote' ) )
        assert_equal( 'LinuxSalad.rb',          @launcher.platform_lookup( 'linux' ) )
        assert_equal( 'RemoteSalad.rb',         @launcher.platform_lookup( 'remote' ) )
    end
end
################################### END OF FILE ################################