#!/usr/bin/python
"""
@brief
Results DB
"""
import os, sys

from unified_modules.test_support.testlogger import TestLogger

from unified_modules.resources.resource_artifactory.resource_artifactory import Artifactory


class ResultsDatabase(object):
    """
    ResultsDatabase
    """

    # def __init__(self, host, port, dbname, user, password):
    #     """
    #     Initialise
    #     """
    #     self.result_id = "dummy"
    #     self.host = host
    #     self.port = port
    #     self.dbname = dbname
    #     self.user = user
    #     self.password = password

    def __init__(self, db_config):
        """
        Init method
        @param db_config - Artifactory resource config dict
        """
        self.db_config = db_config['config']
        self.log_files_list = []

    def single_test_write(self, result_record):
        return self.result_id

    def upload_artifactory(self):
        """Uploading Log files to the artifactory"""
        self.log_file_paths = TestLogger.log_files_list
        self.upload_dir = self.log_file_paths[0].split(os.sep)[0]
        for file in self.log_file_paths:
            logfile = file.split(os.sep)[-1]
            self.log_files_list.append(logfile)


        Artifactory().upload_artifact(self.db_config['upload_artifactory_path'],
                                      self.upload_dir,
                                      self.log_files_list,
                                      (self.db_config['username'], self.db_config['password']))
