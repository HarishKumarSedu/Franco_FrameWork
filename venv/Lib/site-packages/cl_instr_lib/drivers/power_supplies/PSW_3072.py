from cl_instr_lib.base_classes.instek_psw_base_class import InstekPswBaseClass, ProgrammingBounds, ProtectionBounds


class PSW3072(InstekPswBaseClass):
    """Driver class for Instek PSW3072 Power Supply."""

    def __init__(self, visa_resource_name=None, logger=None, **kwargs):

        super().__init__(visa_resource_name, logger,
                         ProgrammingBounds(0.0, 30, 0.0, 72),
                         ProtectionBounds(0.0, 33.0, 0.0, 79.2),
                         model_re='^PSW30-72$',
                         sim_idn='GW-INSTEK,PSW30-72,GEO172493,01.56.20140506',
                         **kwargs)


if __name__ == '__main__':
    ps3072 = PSW3072('COM5')  # Replace visa_resource_name with None for simulated hardware.
    ps3072.debug_options(log_scpi=True, inst_error_handling='LOG_ALWAYS')
