from enum import Enum

from cl_instr_lib.base_classes.instek_psm_base_class import InstekPsmBaseClass, ProgrammingBounds, RangeBounds, ProtectionBounds


class PSM6003(InstekPsmBaseClass):
    """Driver class for Instek PSM6003 Power Supply."""

    # This provides autocomplete and conversion to instrument specific values.
    enum_forcing_ranges = Enum('enum_forcing_ranges', {'LOW': 'P30V', 'HIGH': 'P60V'})

    def __init__(self, visa_resource_name=None, logger=None, **kwargs):

        # Setup the simulation code inherited from Instrument.
        super().__init__(visa_resource_name, logger,
                         RangeBounds(ProgrammingBounds(0.0, 30.9, 0.0, 6.18),
                         ProgrammingBounds(0.0, 61.8, 0.0, 3.4)),
                         ProtectionBounds(0.0, 65.0, 0.0, 6.6),
                         self.enum_forcing_ranges,
                         model_re='^PSM-6003$',
                         sim_idn='GW.Inc,PSM-6003,L173045,FW1.10',
                         **kwargs)


if __name__ == '__main__':
    ps6003 = PSM6003('GPIB0::10')  # Replace visa_resource_name with None for simulated hardware.
    ps6003.debug_options(log_scpi=True, inst_error_handling='LOG_ALWAYS')

