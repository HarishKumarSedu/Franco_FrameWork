from enum import Enum

from cl_instr_lib.base_classes.instek_psm_base_class import InstekPsmBaseClass, ProgrammingBounds, RangeBounds, ProtectionBounds


class PSM2010(InstekPsmBaseClass):
    """Driver class for Instek PSM2010 Power Supply."""

    # This provides autocomplete and conversion to instrument specific values.
    enum_forcing_ranges = Enum('enum_forcing_ranges', {'LOW': 'P8V', 'HIGH': 'P20V'})

    def __init__(self, visa_resource_name=None, logger=None, **kwargs):

        super().__init__(visa_resource_name, logger,
                         RangeBounds(ProgrammingBounds(0.0, 8.24, 0.0, 20.6),
                         ProgrammingBounds(0.0, 20.6, 0.0, 10.3)),
                         ProtectionBounds(0.0, 22.0, 0.0, 22.0),
                         self.enum_forcing_ranges,
                         model_re='^PSM-2010$',
                         sim_idn='GW.Inc,PSM-2010,R880389,FW1.10',
                         **kwargs)


if __name__ == '__main__':
    ps2010 = PSM2010('GPIB0::21')  # Replace visa_resource_name with None for simulated hardware.
    ps2010.debug_options(log_scpi=True, inst_error_handling='LOG_ALWAYS')
