# -----------------------------------------------------------
#                          INCLUDES
# -----------------------------------------------------------
# Inherit from the base class
from cl_instr_lib.base_classes.eloads.PLZ004WL_base import PLZ004WL_base
# Include Other Instrument Drivers/Helpers
# -----------------------------------------------------------
#                            NOTES
# -----------------------------------------------------------
# -----------------------------------------------------------
#                            CLASS
# -----------------------------------------------------------


class PLZ164WL(PLZ004WL_base):
    """
    Class for controlling Kikusui Electronic Load Model PLZ164WL.
    """

    # Device specific limits to be passed into the init of the inherited class
    _ratings = dict()
    _ratings['COND'] = {'L': (30e-6, 1.65), 'M': (300e-6, 16.5), 'H': (3e-3, 165), 'units': 'Siemens (mhos)'}
    _ratings['CURR'] = {'L': (0, 0.5), 'M': (0, 5.0), 'H': (0, 50), 'units': 'Amps'}
    _ratings['POW'] = {'L': (0.165, 1.65), 'M': (1.65, 16.5), 'H': (16.5, 165.0), 'units': 'Watts'}
    _ratings['VOLT'] = {'L': (0.3, 4.0), 'H': (0.3, 30), 'units': 'Volts'}
    _ratings['SLEW'] = {'L': (25e-6, 250e-3), 'M': (250e-6, 250e-3), 'H': (2.5e-3, 2.5), 'units': 'Amps/usec'}
    _rating_curr_max = 55  # Amps
    _rating_pow_max = 181.5  # Watts

    def __init__(self, visa_resource_name=None, logger=None, **kwargs):

        super().__init__(visa_resource_name,
                         logger,
                         model_re='^PLZ164WL$',
                         sim_idn="KIKUSUI,PLZ164WL,RL002001,1.04",
                         **kwargs)


if __name__ == '__main__':
    plz164wl = PLZ164WL('GPIB0::3')
    plz164wl.debug_options(log_scpi=True, inst_error_handling='LOG_ALWAYS')

    test_flag = False
    if test_flag:
        from driver_test_codes.PLZ004WL_test import self_test
        self_test(plz164wl)

# -----------------------------------------------------------
#                          END OF FILE
# -----------------------------------------------------------
