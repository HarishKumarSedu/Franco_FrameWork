import visa


def get_rm_handle(address=None):

    if address is None:
        return None

    rm = visa.ResourceManager()
    rm_list = rm.list_resources()

    address = str(address)
    resource = None
    for i, entry in enumerate(rm_list):
        if address in entry.split('::'):
            resource = entry
            break

    if resource is None:
        raise ValueError(f"No resource found for address: {address}.")

    rm_handle = rm.open_resource(resource)

    return rm_handle
