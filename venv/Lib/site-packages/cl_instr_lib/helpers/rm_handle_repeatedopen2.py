from random import shuffle, sample
import visa

addresses = ['USB0::0x0699::0x0345::C010767::INSTR', 'USB0::0x0699::0x0401::C020226::INSTR', 'USB0::0x0957::0x0907::MY54005712::INSTR',
             'GPIB0::27::INSTR', 'GPIB0::16::INSTR', 'GPIB0::14::INSTR', 'GPIB0::9::INSTR', 'GPIB0::8::INSTR',
             'GPIB0::7::INSTR', 'GPIB0::6::INSTR', 'COM5']
N = 10

handles =[]
for i in range(N):
    shuffle(addresses)
    rm = visa.ResourceManager()
    handles.append([rm.open_resource(r) for r in addresses])

for i in sample(range(N), N):
    print(f"{i:03d}:", end='')
    for h in handles[i]:
        model = f"""'{h.query("*IDN?").split(",")[1]}'"""
        print(f" {model:<15}", end='')
    print()
