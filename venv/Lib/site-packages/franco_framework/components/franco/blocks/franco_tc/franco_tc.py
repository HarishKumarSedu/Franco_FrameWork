from cl_test_station.register_map.custom_block import CustomBlock
from franco_framework.components.franco.blocks.block_template.enums import EnumTemplate
import time

class FrancoTC(CustomBlock):
    """Template class for new Block classes"""

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

    # ToDo: uncomment if you add aliasing the alias YAML does not support
    # def alias(self, **kwargs):
    #     super().alias(**kwargs)
    #     self.attribute = custom logic

    def custom_func(self, arg:int):
        """
        Example of Block API function
        :param arg: value to set to an aliased field
        :type arg: int
        :return: None
        """
        self.some_field_alias.value = arg
        
    def reset(self):
        self.enter_reset()
        self.exit_reset()

    def enter_reset(self):
        """
        assert SIMULINK_MODEL.POWERSTATE_CFG[STANDBY_EN] bit to a '1' every time franco TC reset is called. Have a 10ms delay between standby_en and reset
        :param arg: value to set to an aliased field
        :type arg: int
        :return: None
        """
        self.container.container.SIMULINK_MODEL.POWERSTATE_CFG.STANDBY_EN.value = 1
        time.sleep(0.01)
        self.container.container.find_top_level().enter_franco_tc_reset()

    def exit_reset(self):
        self.container.container.find_top_level().exit_franco_tc_reset()