# -*- coding: utf-8 -*-
"""
Created on Thu May 10 09:29:40 2018

@author: jmunger
"""

import sys
import time
import logging
from smu_2611A import Smu_2611A

idnString = 'Model 2611B'

class Smu_2611B(Smu_2611A):

    def __init__(self,rmHandle):
        self.rmHandle = rmHandle
        self.logger = logging.getLogger('marv.inst.Smu_2611B')
        self.logger.info('Initializing Smu_2611B instrument')


if __name__ == "__main__":
    
    import os
    mgrRootDir = os.path.abspath(os.path.join(os.path.dirname(sys.argv[0]),'..'))
    sys.path.append(mgrRootDir)

    import InstMgr
    instMgr = InstMgr.InstMgr()
    mi = instMgr.checkout( interface='GPIB', addr=26, moduleSuffix='2611B' )
    mi.reset()
    print(mi.getIdn())
#    mi.setOutputVal(output='p5v')
#    mi.setOutputVal(output='P6V',vSet=5.0,iSet=10e-3)
#    mi.setOutputVal(output='P25V',vSet=15.0,iSet=0.1)
#    mi.setOutputVal(output='N25V',vSet=-15.0,iSet=0.1)
    mi.rmHandle.write('display.prompt("0.000", "V", "Enter the value")')
    #set up voltage source with unlimited current
    setupList1 = [('ch1autorangev','off'),
                 ('ch1autorangei','on'),
                 ('ch1voltRange', 2),
                 ('ch1function', 'V'),
                 ('ch1offMode', 'highz'),
                 ('ch1voltLevel', 0),
                 ('ch1voltLimit', 0.01),
                 ('ch1currLimit', 0.1),
                 ]             
    for param,val in setupList1:
        mi.setSrcParam(param=param, val=val)
        
    mi.setOutputState(1,'on')
    mi.setOutputState(1,'off')
   
    mi.close()
    pass    