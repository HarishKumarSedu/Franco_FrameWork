# -*- coding: utf-8 -*-
"""
Created on Tue Jan 07 11:24:17 2020

@author: dzhang
"""

import sys
import logging
from supply_E3646A import *

idnString = 'E3648A'

#this class could benefit from dict structure for setting parameters.
#also, with range settings, there could be more checking for input parameters
#but to make abstraction easier, copy existing class structure
class Supply_E3648A(Supply_E3646A):

    def __init__(self, rmHandle):
        super().__init__(rmHandle)
        self.rmHandle = rmHandle

if __name__ == "__main__":
    import os,sys
    import time
    mgrRootDir = os.path.abspath(os.path.join(os.path.dirname(sys.argv[0]), '..'))
    sys.path.append(mgrRootDir)

    import InstMgr
    instMgr = InstMgr.InstMgr()
    ps = instMgr.checkout(interface='GPIB', addr=5, moduleSuffix='E3648A')
    ps.reset()
    # time.sleep(1)
    # dmm = instMgr.checkout(interface='GPIB', addr=19, moduleSuffix='34401A')
    # time.sleep(1)
    # print(psu.getIdn())
    # psu.setOutputVal(vSet=5, iSet=0.5)
    # time.sleep(1)
    # psu.setOutputStat('ON')
    # time.sleep(1)
    #
    # dmm.setMeasParam('DCV', 'autorange', 'on')
    # time.sleep(1)
    # print(dmm.getMeas())
