# -*- coding: utf-8 -*-
"""
Created on Wed Sep  4 14:42:35 2019

@author: dkaroly
"""

import sys
import logging

from supply_PSM6003 import Supply_PSM6003

idnString = 'PSM-2010'


class Supply_PSM2010(Supply_PSM6003):

    def __init__(self, rmHandle):
        self.rmHandle = rmHandle
        self.logger = logging.getLogger('marv.inst.Supply_PSM2010')
        self.logger.info('Initializing Supply_PSM2010 instrument')
        self.__rangeList__ = ('P8V', 'P20V', 'LOW', 'HIGH')


if __name__ == "__main__":
    import os
    import time

    mgrRootDir = os.path.abspath(os.path.join(os.path.dirname(sys.argv[0]), '..'))
    sys.path.append(mgrRootDir)
    print("MGRROOTDIR" + '-' * 10 + mgrRootDir)

    import InstMgr

    instMgr = InstMgr.InstMgr()
    ps = instMgr.checkout(objName='supply', interface='GPIB', addr=10, moduleSuffix='PSM2010')
    ps.reset()
    print(ps.getIdn())
    ps.value(voltage=3.0, ilimit=1.0)
    out_val = ps.value()
    print(out_val)
    ps.state('ON')
    print(ps.state())
    #    time.sleep(1)

    #    ps.close()
    pass
